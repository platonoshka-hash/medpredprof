{% extends "base.html" %}
{% block content %}
<h1>Админ: Пользователи</h1>

{% if users|length == 0 %}
  <p>Пока нет пользователей.</p>
{% else %}
  <table class="table">
    <thead>
      <tr><th>ID</th><th>Логин</th><th>ФИО</th><th>Класс</th><th>Решено задач</th><th>Правильных</th><th>Регистрация</th><th>Последний вход</th><th>Статус</th><th>Действия</th></tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr class="{{ 'blocked' if u.is_blocked else '' }}">
        <td>{{ u.id }}</td>
        <td>{{ u.login }}</td>
        <td>{{ u.full_name }}</td>
        <td>{{ u.class_name }}</td>
        <td>{{ u.tasks_solved }}</td>
        <td>{{ u.correct_answers }}</td>
        <td>{{ u.created_at[:10] }}</td>
        <td>{{ u.last_login[:10] if u.last_login else 'Никогда' }}</td>
        <td>{{ 'Заблокирован' if u.is_blocked else 'Активен' }}</td>
        <td>
          <form action="{{ url_for('admin_toggle_user_block', user_id=u.id) }}" method="post">
            <button class="{{ 'success' if u.is_blocked else 'danger' }}" type="submit">
              {{ 'Разблокировать' if u.is_blocked else 'Заблокировать' }}
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}
{% endblock %}

